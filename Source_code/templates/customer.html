<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Customer Panel</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .fade-in { animation: fadeIn 0.6s ease-in-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body class="bg-gradient-to-br from-yellow-50 to-amber-100 min-h-screen text-gray-800">


<body class="bg-gradient-to-br from-yellow-50 to-amber-100 min-h-screen text-gray-800">
  <!-- Navigation Bar -->
  <nav class="flex justify-between items-center bg-amber-600 text-white px-6 py-3 shadow">
    <div class="font-bold text-xl">ğŸ½ Smart Restaurant</div>
    <div class="flex gap-4">
      <a href="/" class="hover:underline">ğŸ  Home</a>
      <a href="/logout" class="hover:underline">ğŸšª Logout</a>
    </div>
  </nav>

  <!-- Dashboard Content -->
  <div class="max-w-4xl mx-auto px-4 py-12 fade-in">
    <h1 class="text-4xl font-bold text-center text-amber-700 mb-2">ğŸ‘¤ Welcome, {{ email }}</h1>
    <p class="text-center text-gray-600 mb-8">
      Here are your recent bookings and orders â€” review details or manage reservations below.
    </p>



    <!-- Tabs -->
 <div class="mb-6 flex justify-center gap-6 border-b border-gray-300">
  <button class="tab-btn px-4 py-2 font-semibold border-b-2 border-amber-600 text-amber-600" data-tab="orders">ğŸ“¦ Orders</button>
  <button class="tab-btn px-4 py-2 font-semibold text-gray-600 hover:text-amber-600" data-tab="private">ğŸ›ï¸ Private Rooms</button>
  <button class="tab-btn px-4 py-2 font-semibold text-gray-600 hover:text-amber-600" data-tab="events">ğŸ‰ Events</button>
</div>


    <!-- Results -->
    <div class="space-y-6">
      <div id="tab-orders" class="tab-content">
        <h2 class="text-xl font-bold text-amber-700 mb-4">ğŸ“¦ Orders</h2>
        <div id="orderList" class="grid gap-4"></div>
      </div>

      <div id="tab-private" class="tab-content hidden">
        <h2 class="text-xl font-bold text-amber-700 mb-4">ğŸ› Private Room Bookings</h2>
        <div id="privateList" class="grid gap-4"></div>
      </div>

      <div id="tab-events" class="tab-content hidden">
        <h2 class="text-xl font-bold text-amber-700 mb-4">ğŸ‰ Event Reservations</h2>
        <div id="eventList" class="grid gap-4"></div>
      </div>
    </div>
  </div>

  <script>
    const tabs = document.querySelectorAll('.tab-btn');
    const contents = document.querySelectorAll('.tab-content');

    tabs.forEach(btn => {
      btn.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('border-b-2', 'border-amber-600', 'text-amber-600'));
        contents.forEach(c => c.classList.add('hidden'));
        btn.classList.add('border-b-2', 'border-amber-600', 'text-amber-600');
        document.getElementById(`tab-${btn.dataset.tab}`).classList.remove('hidden');
      });
    });

    window.addEventListener('DOMContentLoaded', async () => {
      try {
        const res = await fetch('/customer/api/customer-data');


        if (!res.ok) throw new Error('Unauthorized');
        const data = await res.json();

        populateSection('orderList', data.orders, (item) => `
          <div class="bg-white p-4 rounded shadow fade-in">
            <p><strong>Date:</strong> ${item.created_at}</p>
            <p><strong>Total:</strong> $${item.total}</p>
            <p><strong>Status:</strong> <span class="capitalize">${item.status}</span></p>
            <p class="text-sm text-gray-500">Items: ${item.item_count}</p>
          </div>
        `);

        populateSection('privateList', data.private_rooms, (item) => `
          <div class="bg-white p-4 rounded shadow fade-in">
            <p><strong>Date:</strong> ${item.date}</p>
            <p><strong>Time:</strong> ${item.time}</p>
            <p><strong>Requests:</strong> ${item.message}</p>
            <p class="text-sm text-gray-500">Booked on: ${item.created_at}</p>
          </div>
        `);

        populateSection('eventList', data.events, (item) => `
          <div class="bg-white p-4 rounded shadow fade-in">
            <p><strong>Event Type:</strong> ${item.event_type}</p>
            <p><strong>Date:</strong> ${item.date}</p>
            <p><strong>Guests:</strong> ${item.guests}</p>
            <p><strong>Message:</strong> ${item.message}</p>
            <p class="text-sm text-gray-500">Reserved on: ${item.created_at}</p>
          </div>
        `);
      } catch (err) {
        console.error(err);
        alert('âŒ Failed to load your records.');
      }
    });

    function populateSection(containerId, items, templateFn) {
      const container = document.getElementById(containerId);
      container.innerHTML = items.length
        ? items.map(templateFn).join('')
        : '<p class="text-gray-500 italic">No records found.</p>';
    }
  </script>
</body>
</html>
