<section id="event-reservation" class="section bg-charcoal text-ivory">
  <div class="container max-w-6xl mx-auto px-4">

    <!-- üéâ Section Header -->
    <div class="section-head text-center mb-12">
      <h2 class="section-title text-gold">Event Reservations</h2>
      <p class="section-sub text-ivory/70 max-w-2xl mx-auto">
        Celebrate your special occasions in style. Reserve space for weddings, corporate gatherings, or private parties.
      </p>
    </div>

    <!-- üñºÔ∏è Layout: Image + Form -->
    <div class="grid md:grid-cols-2 gap-10 items-center">

      <!-- üì∏ Event Image -->
      <div class="rounded-2xl overflow-hidden border border-gold/10 shadow-gold/10">
        <img 
          src="https://images.unsplash.com/photo-1525610553991-2bede1a236e2?q=80&w=1920&auto=format&fit=crop" 
          alt="Event Hall" 
          class="w-full h-[400px] object-cover hover:scale-105 transition-transform duration-700 ease-in-out">
      </div>

      <!-- üìù Booking Form -->
      <div id="eventFormWrapper" class="panel bg-charcoal-2 p-6 rounded-2xl border border-gold/10 shadow-gold/10">
        <h3 class="panel-title text-gold mb-4 flex items-center gap-2">
          <i class="fa-solid fa-champagne-glasses text-gold"></i> Book Your Event
        </h3>

        <p class="text-ivory/70 mb-5 text-sm">
          Fill out the form below to reserve space for your event. We‚Äôll contact you shortly to finalize your booking.
        </p>

        <!-- ‚úÖ Working Event Reservation Form -->
        <form id="eventReservationForm" class="space-y-4">
          <div>
            <label class="label">Your Name</label>
            <input type="text" name="name" class="input" placeholder="John Doe" required>
          </div>

          <div>
            <label class="label">Email</label>
            <input type="email" name="email" class="input" placeholder="john@example.com" required>
          </div>

          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="label">Event Type</label>
              <input type="text" name="event_type" class="input" placeholder="Wedding, Party, Conference..." required>
            </div>
            <div>
              <label class="label">Guests</label>
              <input type="number" name="guests" class="input" placeholder="Number of guests" required>
            </div>
          </div>

          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="label">Date</label>
              <input type="date" name="date" class="input" required>
            </div>
            <div>
              <label class="label">Time</label>
              <input type="time" name="time" class="input" required>
            </div>
          </div>

          <div>
            <label class="label">Additional Details</label>
            <textarea name="message" class="input" placeholder="Tell us more about your event..."></textarea>
          </div>

          <button type="submit" class="btn btn-gold w-full font-semibold text-charcoal mt-2">
            <i class="fa-solid fa-calendar-check mr-2"></i> Submit Reservation
          </button>
        </form>

        <!-- üí¨ Message Display -->
        <div id="eventFormMessage" class="mt-4 text-center text-sm"></div>
      </div>
    </div>

    <!-- üéüÔ∏è CTA -->
    <div class="text-center mt-12">
      <button id="showEventForm" class="btn btn-accent px-6 py-3">
        <i class="fa-solid fa-calendar-days mr-2"></i> Reserve Your Event
      </button>
    </div>

  </div>

  <!-- üß† JS Script -->
  <script>
  document.addEventListener("DOMContentLoaded", () => {
    const eventForm = document.getElementById("eventReservationForm");
    const msgBox = document.getElementById("eventFormMessage");

    eventForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      msgBox.textContent = "Submitting your reservation...";
      msgBox.className = "text-ivory/70 text-sm mt-3";

      const formData = new FormData(eventForm);
      const data = Object.fromEntries(formData.entries());

      try {
        const res = await fetch("/customer/api/event-reservation", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });

        const result = await res.json();

        if (res.status === 401 && result.login_required) {
          msgBox.innerHTML = "‚ö†Ô∏è Please <a href='/otp_login' class='text-gold underline'>login</a> to reserve an event.";
          msgBox.className = "text-red-400 mt-3 text-sm";
        } 
        else if (result.success) {
          msgBox.textContent = "‚úÖ Reservation submitted successfully!";
          msgBox.className = "text-green-400 mt-3 text-sm";
          eventForm.reset();
        } 
        else {
          msgBox.textContent = "‚ùå " + (result.error || "Something went wrong. Try again.");
          msgBox.className = "text-red-400 mt-3 text-sm";
        }
      } catch (error) {
        console.error("Error:", error);
        msgBox.textContent = "‚ùå Network error. Please try again later.";
        msgBox.className = "text-red-400 mt-3 text-sm";
      }
    });
  });
  </script>
</section>
